<!DOCTYPE html>
<html>
<head>
    <title>Leggings</title>
    <link rel="stylesheet" href="css/style.css">
    <!--<script src="js/main.js"></script>-->
    <style>
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            grid-gap: 20px;
            padding: 20px;
        }

        .image-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .additional-text {
            font-size: 12px;
            color: #888;
            margin-bottom: 0px;
        }

        .size {
            font-size: 12px;
            color: #888;
            margin-bottom: 0px;
        }

        .price {
            font-size: 14px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 0px;
        }

        .stock {
            font-size: 14px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 0px;
        }

        .max-qty {
            margin-left: 2px;
        }

        .image-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

            .image-container img {
                max-width: 100%;
                height: 300px;
                margin-bottom: 10px;
            }

            .image-container p {
                margin: 5px 0;
            }

            .image-container button {
                margin-top: 5px;
            }

        .sort-options {
            margin: 20px;
            text-align: center;
        }

            .sort-options button {
                padding: 6px 12px;
                font-size: 14px;
                background-color: #4CAF50;
                color: white;
                border: none;
                cursor: pointer;
                margin: 0 5px;
            }

                .sort-options button.active {
                    color: greenyellow;
                }
    </style>
</head>
<body>
    <header>
        <h1>Leggings Emporium</h1>
        <div class="cart-icon">
            <!--<i class="fas fa-shopping-cart"></i>-->
            <span class="cart-count">0</span>
        </div>
    </header>
    <nav>
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="cart.html">Cart</a>
        <a href="#">Contact</a>
        <a href="#">FAQ</a>
    </nav>
    <main>
        <h2>Shop</h2>
        <!--<input type="file" id="csvFile" accept=".csv">-->
        <div class="sort-options">
            <button id="sortHighToLow" onclick="sortImages('high-to-low')" class="active">Sort High to Low</button>
            <button id="sortLowToHigh" onclick="sortImages('low-to-high')">Sort Low to High</button>
        </div>
        <div class="image-grid" id="imageGrid"></div>
        <div class="image-grid" id="imageGrid"></div>
    </main>
    <script>
        const csvFileName = '../data/leggings stock.csv'; // Set the fixed CSV file name here
        let imageData = []; // Store the image data
        let currentSortOrder = 'high-to-low';

        fetch(csvFileName)
            .then(response => response.text())
            .then(data => {
                processCSV(data);
                renderImages();
            })
            .catch(error => {
                console.error('Error reading CSV file:', error);
            });

        function processCSV(csvData) {
            const rows = csvData.trim().split('\n');
            for (let i = 1; i < rows.length; i++) {
                const [filename, width, height, description, additionalText, priceStr, size, stock] = rows[i].split(',');
                const price = parseFloat(priceStr.trim());
                imageData.push({ filename, width, height, description, additionalText, price: isNaN(price) ? 0 : price, size, stock });
            }
        }

        function renderImages() {
            const imageGrid = document.getElementById('imageGrid');
            imageGrid.innerHTML = '';

            imageData.forEach(item => {
                const imageDiv = document.createElement('div');
                imageDiv.classList.add('image-container');

                const img = document.createElement('img');
                img.src = item.filename;
                img.width = parseInt(item.width);
                img.height = parseInt(item.height);
                imageDiv.appendChild(img);

                const descriptionP = document.createElement('div');
                descriptionP.classList.add('description');
                descriptionP.textContent = item.description;
                imageDiv.appendChild(descriptionP);

                const additionalTextP = document.createElement('div');
                additionalTextP.classList.add('additional-text');
                additionalTextP.textContent = item.additionalText;
                imageDiv.appendChild(additionalTextP);

                const sizeP = document.createElement('div');
                sizeP.classList.add('size');
                sizeP.textContent = "Size: " + item.size;
                imageDiv.appendChild(sizeP);

                const priceP = document.createElement('div');
                priceP.classList.add('price');
                priceP.textContent = `Price: R${item.price.toFixed(0)}`;
                imageDiv.appendChild(priceP);

                const stockContainer = document.createElement('div');
                stockContainer.classList.add('stock-container');

                const stockP = document.createElement('div');
                stockP.classList.add('stock');
                stockP.textContent = "Stock: " + item.stock;
                stockContainer.appendChild(stockP);

                const inputQ = document.createElement('input');
                inputQ.setAttribute('type', 'number');
                inputQ.setAttribute('id', 'quantity1');
                inputQ.setAttribute('name', 'quantity1');
                inputQ.setAttribute('min', '0');
                inputQ.setAttribute('max', '999');
                inputQ.setAttribute('value', '1');
                //inputQ.textContent = "Qty:";
                stockContainer.appendChild(inputQ);

                const maxbutton = document.createElement('button');
                maxbutton.classList.add('max-qty');
                maxbutton.setAttribute('name', item.description);
                maxbutton.textContent = 'Max';
                //maxbutton.addEventListener('click', () => {
                //    // Add your cart functionality here
                //    console.log(`Set "${item.description}" max qty.`);
                //});
                stockContainer.appendChild(maxbutton);
                imageDiv.appendChild(stockContainer);

                const button = document.createElement('button');
                button.classList.add('add-to-cart');
                button.setAttribute('price', item.price);
                button.setAttribute('name', 'Leggings1');
                button.textContent = 'Add to Cart';
                //button.addEventListener('click', () => {
                //    // Add your cart functionality here
                //    console.log(`Added "${item.description}" to the cart.`);
                //});
                imageDiv.appendChild(button);

                imageGrid.appendChild(imageDiv);
            });

        }

        function sortImages(order) {
            currentSortOrder = order;
            updateSortButtonStyles();
            if (order === 'high-to-low') {
                imageData.sort((a, b) => b.price - a.price);
            } else if (order === 'low-to-high') {
                imageData.sort((a, b) => a.price - b.price);
            }
            renderImages();
        }

        function updateSortButtonStyles() {
            const sortHighToLowButton = document.getElementById('sortHighToLow');
            const sortLowToHighButton = document.getElementById('sortLowToHigh');

            sortHighToLowButton.classList.remove('active');
            sortLowToHighButton.classList.remove('active');

            if (currentSortOrder === 'high-to-low') {
                sortHighToLowButton.classList.add('active');
            } else if (currentSortOrder === 'low-to-high') {
                sortLowToHighButton.classList.add('active');
            }
        }
    </script>
    <script src="js/main.js"></script>
    <div class="cart">
        <h2>Shopping Cart</h2>
        <div class="cart-items">
            Cart items will be added here dynamically
        </div>
        <p>Total: R0</p>
        <a href="cart.html"><button>Checkout</button></a>
    </div>
</body>
</html>